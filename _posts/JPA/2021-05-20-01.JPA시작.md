---
title: "JPA 01.JPA 시작"
excerpt: "JPA 기본 설정 및 특징"
categories:
    - JPA
tags:
    - JPA
last_modified_at: 2021-05-20
---

# JPA 기본 설정
* Spring JPA를 설정하는 방법은 크게 두가지가 있다.
    * Persistence.XML 설정 (MAVEN)
        * ```
          <?xml version="1.0" encoding="UTF-8"?>
          <persistence version="2.2"
            xmlns="http://xmlns.jcp.org/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd">
            <!-- Persistence 이름 설정 -->
            <persistence-unit name="이름입력">
              <properties>
                  <!-- 필수 속성 -->
                  <property name="javax.persistence.jdbc.driver" value="org.h2.Driver"/>
                  <property name="javax.persistence.jdbc.user" value="sa"/>
                  <property name="javax.persistence.jdbc.password" value=""/>
                  <property name="javax.persistence.jdbc.url" value="jdbc:h2:tcp://localhost/~/test"/>
                  <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
                  
                  <!-- 옵션 -->
                  <property name="hibernate.show_sql" value="true"/>
                  <property name="hibernate.format_sql" value="true"/>
                  <property name="hibernate.use_sql_comments" value="true"/>
                  <!--<property name="hibernate.hbm2ddl.auto" value="create" />-->
              </properties>
            </persistence-unit>
          </persistence>
          ```
    * SpringBoot 설정파일에서 설정 (GRADLE)
        * ```
          spring: 
            datasource: 
              url: 접속 URL 
              username: Id 
              password: password 
              driver-class-name: DB 드라이버
          
          # 추가 설정 
          jpa: 
            hibernate: 
                ddl-auto: create 
          
            properties: 
                hibernate: 
                    # show_sql: true 
                    format_sql: true 
                    default_batch_fetch_size: 100
          ```
## 필수 속성
<img src="/image/JPA/ch1/properties.png" alt="필수_속성.png" class="align-center">

### DB 방언
* 필수 속성 설정을 하다 보면 `DB 방언` 이라는 것을 보게 된다.
* **표준어와 사투리**를 생각해보자. 한국에서 우리는 여러 사투리를 쓰고 있다. 같은 뜻이나, 다른 단어인 경우가 많다. 
* DB도 마찬가지다. SQL표준 언어(표준어)가 있는 반면 각 DB마다 내포하는 의미는 같지만, 다른 키워드를 쓰는 단어(사투리)도 있다.
* 그러니 JPA는 같은 결과를 출력해도 설정한 DB 마다 다른 키워드가 나가야 되는데, 이를 도와주는 것이 `DB 방언`이라고 한다.
  * ex: `MySQL의 SUBSTRING()`, `Oracle의 SUBSTR()`은 같은 기능을 가진다.
* DB 방언은 **JPA는 특정 DB에 종속적이지 않게 해주는 핵심 기능이다.**

<img src="/image/JPA/ch1/dialect.png" alt="DB_방언.png" class="align-center">

#### DB 방언 설정
* H2 : org.hibernate.dialect.H2Dialect
* Oracle 10g : org.hibernate.dialect.Oracle10gDialect
* MySQL : org.hibernate.dialect.MySQL5InnoDBDialect

## 추가 설정
* `hibernate.show_sql` : Run 시 SQL문을 볼 것인가 설정.
* `hibernate.format_sql` : SQL 포맷으로 깔끔하게 보여주는 옵션
* `hibernate.hbm2ddl.auto value="전략 선택" />` : **스키마 자동 생성 기능.**

### 데이터베이스 스키마 자동 생성 (hibernate.hbm2ddl.auto)
* 어플리케이션 운영단계가 아닌 개발단계 에서는 컬럼을 추가하거나 엔티티를 수정할 일이 많다.
* 그래서 **어플리케이션 실행 시점에서 매핑정보와 DB 방언을 이용해 스키마를 생성**하게 하면 편해진다.
* **기존의 DB 테이블을 먼저 짜고 후에 객체를 생성하는 테이블 중심 패러다임이 객체 중심 패러다임으로 변화!**

#### 종류
<img src="/image/JPA/ch1/DDL.png" alt="필수_속성.png" class="align-center">

#### 주의사항
* **개발단계에서만 사용하고 운영단계에서는 절대 사용하지 말것. (삐끗했다가 DB 다 날라간다.)**

***

#### 출처
* JPA Reference : [https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#reference](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#reference)
* 도서 : 자바 ORM 표준 JPA 프로그래밍
