---
title: "스트림 활용 : 매핑"
excerpt: "`map`, `Arrays.stream()`, `limit`, `flatMap`과 같은 매핑 기능을 배워보자."
categories:
    - JAVA8
  tags:
    - Stream
last_modified_at: 2021-05-16
---

# 매핑
객체에서 특정 데이터를 선택하는 작업은 매우 흔한 일이다. 이번에는 이 **특정 데이터를 선택하는 기능**을 알아보자.

## 스트림의 각 요소에 함수 적용
### map()
* `map()`은 함수를 인수로 받으며, **인수로 제공된 함수는 각 요소에 적용.
* 함수의 결과들로 **새로운 스트림을 만들어서 매핑.**
    ```java
    void mappingDishNameLength() {
        List<Integer> dishNameLength = menu.stream()    // Type : Stream<Dish>
                .map(Dish::getName)                     // Type : Stream<String>
                .map(String::length)                    // Type : Stream<Integer>
                .collect(toList());
        System.out.println("메뉴명 길이 = " + dishNameLength);
    }
    ```

## 스트림 평면화
* 이전에 배운 `distinct()`를 이용해 고유 문자로 이루어진 리스트를 반환해 보자.
  ```java
    // Q: ["Hello", "World"], Ans: ["H", "e", "l", "o", "W", "r", "d"]
    static void badDistinctWord() {
        List<String[]> distinctList = StreamMapping.distinctList.stream()
                             .map(word -> word.split(""))    // Stream<String[]>
                             .distinct()
                             .collect(toList());
        System.out.println("중복되지 않는 문자 = " + distinctList);
        // 결과 : "Hello", "World"
        }
  ```
    * 문제는 `map()`으로 전달한 split() 람다는 `String[]` 타입으로 반환된다는 것이다.  
      `String[] split = distinctList.get(0).split("");`
    * 그래서 우리가 원하는 `char` 단위가 아닌 `String[]의 원소`를 한 묶음으로 보기 때문에 이런 결과가 나오게 된다.
    <img src="/image/JAVA8/ch5/ch5_2.png" alt="map반환.png" class="align-center">
      
    * 우리가 원하는 타입은 `String[]`이 아닌 `String` 타입이다.
    * 그렇기 때문에 **먼저 각 단어를 개별 문자열로 이루어진 배열로 만든 후 각 배열을 별도의 스트림으로 다시한번 만들어야 한다.**


### flatMap
* `flatMap()`을 사용하면 문제가 해결된다.
    ```java
    private static void distinctWordByFlatMap() {
        List<String> result = distinctList.stream()    // Stream<String>
                .map(word -> word.split(""))           // Stream<String[]>
                .flatMap(Arrays::stream)               // Stream<Stream<String>> -> Stream<String>
                .distinct()
                .collect(toList());
        System.out.println("flatMap 사용 = " + result);
    }
    ```
    <img src="/image/JAVA8/ch5/ch5_3.png" alt="flatMap.png" class="align-center">
    * 우선 `Arrays.stream()` 메소드를 한번 더 실행해 **문자열 리스트가 아닌, 문자열 스트림을 만들자.**
    * `flatMap()`은 각 배열을 스트림이 아닌 스트림의 요소로 매핑을 한다.
    * 쉽게 말하자면, **복합 스트림이 `평면화` 되어 한 스트림으로 합쳐진다는 소리다.**



## 요약
### map( )
* `map()`은 함수를 인수로 받으며, 그 결과들로 **새로운 스트림을 만들어서 매핑.**

### flatMap( )
* 복합 스트림을 하나의 스트림으로 **평면화** 시켜서 새로운 스트림에 매핑.
  * ex: `Stream<Stream<String>> -> 새로운 Stream<String>`


### 참고 자료
* 모던 자바 인 액션
* JAVA Reference