---
title: "스트림 활용 : 검색과 매칭"
excerpt: "`anyMatch`, `allMatch`, `noneMatch`, `findAny`, `findFirst`  같은 스트림 검색과 매칭 기능을 배워보자."
categories:
    - JAVA8
  tags:
    - Stream
  last_modified_at: 2021-05-16
---
# 검색과 매칭
* **특정 속성이 데이터 집합에 있는지 여부를 검색**하는 데이터 처리도 자주 사용된다.

## anyMatch
* Predicate가 주어진 스트림에서 **한 요소라도 True를 반환하면  True으로 출력이 된다. (최종연산)**
    ```java
    if(menu.stream.anyMatch(Dish::isVegetarian)) {      // boolean 타입으로 반환이 된다.
        System.out.println("채식주의자를 위한 메뉴 입니다.")
    }
    ```
## allMatch
* 주어진 스트림에서 **반드시 모든 요소가 True를 반환해야 한다.**

## noneMatch
* `allMatch`의 반대. **반드시 모든 요소가 False를 반환해야 한다.**

## findAny
* **현재 스트림에서 조건에 해당하는 아무 요소를 반환. `Optional<T>` 타입을 반환.**
* `Optional<T>`은 **아무 요소도 반환하지 않을(null) 경우 에러를 피하기 위해 설계된 컨테이너 클래스**다.

## findFirst
* `sort`와 같은 논리적 순서가 있는 경우 첫번째 요소를 반환.
* 정렬이 된 경우에 퍼포먼스가 높다.

## findAny vs findFirst
* 일반적인 상황에서는 둘다 첫번째 요소를 반환한다. 그런데 왜 두개를 따로 만들었을까?
* 바로 **병렬성** 때문이다. 병렬 실행에서는 첫 번째 요소를 찾기가 어렵다. (뭐를 먼저 찾았는지 모르기 때문..)
* 그렇기 때문에 반환 순서가 상관이 없다면, 병렬 스트림에서는 그냥 `findAny`를 사용하고, 아니면 `findFirst`를 사용한다.
* 당연히 `findAny`가 제약이 적다.

## 쇼트 서킷
* 이 **세 메소드들은 스트림 쇼트 서킷 기법을 사용**한다. (자바에서 `&&`, `||` 연산자를 떠올리면 쉽다.)
    * 쇼트 서킷은 전체 스트림을 처리하지 않아도 결과를 반환하는 것
        * `and` 연산중 하나라도 `false`이 나오면 전체적인 결과는 `false`  
          이기 때문에 더이상 연산을 하지 않고 `false`를 반환하는 방법이다.
    * 검색과 매칭을 지원하는 모든 메소드들이 이처럼 전체 스트림을 처리하지 않아도 결과를 반환할 수 있다.
    * 그래서 순서도 중요하다.

<img src="/image/JAVA8/ch5/ch5_4.png" alt="쇼트 서킷정리.png" class="align-center">
***

# 요약
* anyMatch : 한 요소라도 True -> True
* allMatch : 모든 요소가 True -> True
* noneMatch : 모든 요소가 False -> True
* findAny : 현재 조건에 해당하는 아무 요소 반환
* findFirst : 현재 조건에 해당하는 첫번째 요소 반환 (정렬된 데이터여야 효과가 높다.)
* **Optional<T> : `NullPoint`를 방지하기 위한 컨테이너 클래스.**

## 참고 자료
* 모던 자바 인 액션
* JAVA Reference